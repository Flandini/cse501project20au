#include "lib.h"
#include <stdio.h>

// int32_t* scan_line (char* clause_line)
// {
//     char* lit; // generated by idx of iterator

//     // strsplit pattern gen
//     char* delim0 = " ";
//     char* clause_line_dup = strdup (clause_line);
//     char** iter0 = str_split (clause_line_dup, delim0);

//     // pattern of acc is another iterator. same length as iter1
//     int32_t* literals = calloc (iter_length((void**) iter0), sizeof(int32_t));

//     // for loop
//     for (uint32_t i0 = 0; (lit = iter0[i0]); ++i0)
//     {
//         // indexed by idx var b/c acc is iter
//         literals[i0] = atoi(lit);
//     }

//     // generated by strsplit
//     free (iter0);
//     free (clause_line_dup);

//     return literals;
// }

// Generated by DSL - OLD
// int32_t* gen_scan_line(char* clause_line) {
//     char* lit;
//     char* delim0 = " ";
//     char* pass_through_0 = clause_line;
//     char* pass_through_0_dup_0 = strdup(pass_through_0);
//     char** iterator0 = str_split(pass_through_0_dup_0, delim0);
//     int32_t* literals  = calloc(iter_length((void**) iterator0), sizeof(int32_t));
//     for (uint32_t i_0 = 0; (lit = iterator0[i_0]); ++i_0) {

//         literals[i_0] = atoi(lit);
//     }

//     free (pass_through_0_dup_0);
//     return literals;
// }

// uint8_t array_average(int32_t* numbers)
// {
//     // from iterator
//     // iterator is varname, so no extra decl
//     int32_t n;

//     // acc
//     uint32_t acc = 0;

//     for (uint32_t i0 = 0; (n = numbers[i0]); ++i0)
//     {
//         acc = acc + n;
//     }

//     uint8_t averageish = acc / iter_length((void**) numbers);
//     return averageish;
// }

// Generated by DSL - OLD
// int32_t gen_array_average(int32_t* numbers) {
//     int32_t n;
//     uint32_t acc = 0;

//     for (uint32_t i_0 = 0; (n = numbers[i_0]); ++i_0) {

//         acc = acc + n;
//     }

//     uint8_t averagish = acc / iter_length((void**) numbers);
    
//     return averagish;
// }

int LLVMFuzzerTestOneInput(const uint8_t *Data, size_t Size) {
  if (Size == 0 || Data[Size-1]) return 0;
  char* clause = (char*) Data;
  int32_t* tokens = scan_line (clause);
  free (tokens);
  return 0;
}

// int main()
// {
//     char* clause_line = "1 2 3 4 0";
//     //int* tokens = gen_scan_line(clause_line);
//     int* tokens = scan_line("\n");
//     for (int i = 0; tokens[i]; ++i)
//     {
//         printf("Token: %d\n", tokens[i]);
//     }

//     free(tokens);
//     return 0;
// }